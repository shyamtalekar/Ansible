---
# #Add trusted certificates to the system trust store

- name: Ensure ca-trust directory exists
  file: 
    path: "/etc/pki/ca-trust/source/anchors/"
    state: directory


- name: Ensure Cert Files Exist
  copy:
    content: '{{ item.value.certificate }}'
    dest: '/etc/pki/ca-trust/source/anchors/{{ item.key }}.{{ base_cert_suffix }}'
    owner: "root"
    group: "root" 
    mode: "0644"
  loop: '{{ base_ca_certs | dict2items }}'
  notify: 
    - Update ca_trust





Variables:

---

base_cert_suffix: "pem" 
base_cert_store: "CA" 
base_update_trust_cmd: "/usr/bin/update-ca-trust"

base_ca_certs:

  CORPROOTCA:
    thumbprint: '52086bd08c1f5a0587b751c3286fb5bb1f0efdb9'
    cert_store: 'Root'
    certificate: |
      -----BEGIN CERTIFICATE-----
      MIIDBTCCAe2gAwIBAgIQTJYpOXsdsZZIETKAAz4v7zANBgkqhkiG9w0BAQsFADAV
      MRMwEQYDVQQDEwpDT1JQUk9PVENBMB4XDTE3MDQyNTE5NDYyMFoXDTI3MDQyNTE5
      NTYyMFowFTETMBEGA1UEAxMKQ09SUFJPT1RDQTCCASIwDQYJKoZIhvcNAQEBBQAD
      ggEPADCCAQoCggEBAJprtPs4GvD7wf4gKZWCc0j4c7J42PmGM5E+bNyad06Ui3uS
      XcbB2DTvzRac3M8hlWkEQsVwvGcHm/zMXwpl2pYitoqeKIk/hCUtJkcAKCWaPVw8
      UHyTwC9h0bWud/fvD0kCkH3BafJFK6E0DybyEiDiYurykAwR/rpy/FL+z6OdVdf5
      UAtrtKBdx+UDT9PYveeOFGabtnXSPMep30JJuioEw3L68JAO6Gk5YhJcsoDvHO+l
      c9Vry5NbRVSS1/fhIEXhe5RWiE7UyblE7I43wpaYuVlOYEuLw1aEMP6TkNd8x/Hm
      uddyiFdfjCGCEvXTL2vBdzXcJX/cIBfvYVcD7nsCAwEAAaNRME8wCwYDVR0PBAQD
      AgGGMA8GA1UdEwEB/wQFMAMBAf8wHQYDVR0OBBYEFIvM7EwtJ/zPBbxN3ebLabLa
      H4aQMBAGCSsGAQQBgjcVAQQDAgEAMA0GCSqGSIb3DQEBCwUAA4IBAQBLMfmyj9M2
      VbP8tqoimoQcnvCVtlGCjwrV20KK3wpk9JQTvGfMLPnzF4jQYIRqa++3soTnEitZ
      plXeytJLCBvN6V0WZFku4c4qCxUdPfdsMNseMrfe8xVgFpwKap0ACXodINH/FnSv
      pRCPQ1+6LloTfnfnPy0l5Fqki17ETOrh9G8owPEIUEgyB8ZkK8+9BDwEDP5W4TPJ
      9VhEebD+jHixQem0J5sr9dZO10pQMUixrYT7nkq9fqdv3R3DW+ReuddARWvCKxka
      N/EHDnqE9QqXZBiv446Jm++6g8JFOIaO3eiz/VExzeonHQl74lvaTUzex1nTvUO5
      LcSiC2A2o92D
      -----END CERTIFICATE-----

  CorpSubCA1:
    thumbprint: 'e5704f80dffc35fee0b31e098358f69ee81c7cae'
    certificate: |
      -----BEGIN CERTIFICATE-----
      MIIFrjCCBJagAwIBAgITUAAAAAflCzxvf6h2JAAAAAAABzANBgkqhkiG9w0BAQsF
      ADAVMRMwEQYDVQQDEwpDT1JQUk9PVENBMB4XDTIxMDQxNzE1NTczOVoXDTI2MDQx
      NzE2MDczOVowQjETMBEGCgmSJomT8ixkARkWA2NvbTEWMBQGCgmSJomT8ixkARkW
      Bmhld2l0dDETMBEGA1UEAxMKQ29ycFN1YkNBMTCCASIwDQYJKoZIhvcNAQEBBQAD
      ggEPADCCAQoCggEBAOXr7McJQ+p0+UZfwgPpCuoNooexYQ0E+r/cABvX+vTYBPbL
      t8HvP9/zP63iE1VdmtczxLQWVLGg8xgJrj5LVYgKW2LutbqMg4URtbofPI9NuIJs
      2/NxDrJFzzlJnLGDMddZV+AwCclZg33ZIPFwAruU7QFT5L3prjn/JDWuxHnz99aL
      CiSz0dJ1FNz6D5yoe9Pbc7HZ22aXI32J2gDbQnEPfDPP5YIWId+WKrC5h0pD7pBu
      7aWzsOW+VPMYn9DXTpUPkidtlw6Yk8sSStlCKfCBju5be9f2qv2B3pw/ZadmWAch
      +qfTDjvwA2biR1ZDamT7DfL9rB8nVOGTvdcTU40CAwEAAaOCAsgwggLEMBAGCSsG
      AQQBgjcVAQQDAgEBMCMGCSsGAQQBgjcVAgQWBBR+Gh8ulGDYHcb2Cfcr9v0Oc8aP
      +TAdBgNVHQ4EFgQUukLX1MyOzx2RBetHiNTOwl10USQwGQYJKwYBBAGCNxQCBAwe
      CgBTAHUAYgBDAEEwCwYDVR0PBAQDAgGGMA8GA1UdEwEB/wQFMAMBAf8wHwYDVR0j
      BBgwFoAUi8zsTC0n/M8FvE3d5stpstofhpAwggECBgNVHR8EgfowgfcwgfSggfGg
      ge6GgbdsZGFwOi8vL0NOPUNPUlBST09UQ0EsQ049TFNWV0lQQVAwMDEsQ049Q0RQ
      LENOPVB1YmxpYyUyMEtleSUyMFNlcnZpY2VzLENOPVNlcnZpY2VzLENOPUNvbmZp
      Z3VyYXRpb24sREM9YWQtaGV3aXR0LERDPWNvbT9jZXJ0aWZpY2F0ZVJldm9jYXRp
      b25MaXN0P2Jhc2U/b2JqZWN0Q2xhc3M9Y1JMRGlzdHJpYnV0aW9uUG9pbnSGMmh0
      dHA6Ly9pbnRQS0kuaGV3aXR0LmNvbS9DZXJ0RW5yb2xsL0NPUlBST09UQ0EuY3Js
      MIIBCgYIKwYBBQUHAQEEgf0wgfowgasGCCsGAQUFBzAChoGebGRhcDovLy9DTj1D
      T1JQUk9PVENBLENOPUFJQSxDTj1QdWJsaWMlMjBLZXklMjBTZXJ2aWNlcyxDTj1T
      ZXJ2aWNlcyxDTj1Db25maWd1cmF0aW9uLERDPWFkLWhld2l0dCxEQz1jb20/Y0FD
      ZXJ0aWZpY2F0ZT9iYXNlP29iamVjdENsYXNzPWNlcnRpZmljYXRpb25BdXRob3Jp
      dHkwSgYIKwYBBQUHMAKGPmh0dHA6Ly9pbnRQS0kuaGV3aXR0LmNvbS9DZXJ0RW5y
      b2xsL0xTVldJUEFQMDAxX0NPUlBST09UQ0EuY3J0MA0GCSqGSIb3DQEBCwUAA4IB
      AQARUZU2SAr5wQrOrmDYjabmTPpk8k2GK5T0CmhLq+iuSrqSTRzEzQQVL6IfhDYf
      19bNQZSVUk13HMZ4UbvO6AhFUtYXKjtYtAKoBxd+b/UeEzXhyoPfVNW3sewavEjX
      PBR8JxdjAGGAuFi98qJtavoiUCgYPMOBgg0Px/X1iBROe9OBWy6qm4/s3od3OA2V
      3d3lH7OMfB3eTpMios9l+8fWddty0NTwQM2GQTwI09hOhvgWeuhZTVhIWJDkP3SD
      1Ql2DVik10Wq3lAI4OGomzk9TzN4mImWXiXIaPF+rLm8cqWjGfht6+vDIBinre9W
      GJd6tXpf4NLKTxSsH+yUFueq
      -----END CERTIFICATE-----

  CorpSubCA2:
    thumbprint: 'f9d42b49ca4d497f29866588180e4feab05d64f5'
    certificate: |
      -----BEGIN CERTIFICATE-----
      MIIFrjCCBJagAwIBAgITUAAAAAYKuPI4wyM4UAAAAAAABjANBgkqhkiG9w0BAQsF
      ADAVMRMwEQYDVQQDEwpDT1JQUk9PVENBMB4XDTIxMDQxNzE1MjcyNloXDTI2MDQx
      NzE1MzcyNlowQjETMBEGCgmSJomT8ixkARkWA2NvbTEWMBQGCgmSJomT8ixkARkW
      Bmhld2l0dDETMBEGA1UEAxMKQ29ycFN1YkNBMjCCASIwDQYJKoZIhvcNAQEBBQAD
      ggEPADCCAQoCggEBALOZckDVHjbmvOjq7rk8beNEI5gKPoU0ar657aZ/I5AT15UK
      XmYay3JlPZJPtZOIn8Np9CtOO2iusMvc9lB8ecFS2slYhjB/RNKjLetawv4inkpb
      5t0E5jKJnE4QKtitvdZP5TfX+tYunyvmZHTensg7Zv2US8cvBi881zkJerc9X5kh
      oFMcHEhNonxxabJShs0JCvofY2J+ulVgnyEJCaHQPAjGz/+njl8PL/7by3g6MiDT
      WSVnbi6wtme74v2taE5oJWBM5w0bllTJRuQk3HoYMojP/PQfa2cXNt9iiml7k5lG
      xZ4h7GvqYiog7TDfieE6o7IA9+Q3LPZ7EFWExQ0CAwEAAaOCAsgwggLEMBAGCSsG
      AQQBgjcVAQQDAgEBMCMGCSsGAQQBgjcVAgQWBBQ18nifXgmtaSq4MuiSh6QOdAoy
      TTAdBgNVHQ4EFgQUFc/DFXBYs3Sek1MG24C6jcl8wEUwGQYJKwYBBAGCNxQCBAwe
      CgBTAHUAYgBDAEEwCwYDVR0PBAQDAgGGMA8GA1UdEwEB/wQFMAMBAf8wHwYDVR0j
      BBgwFoAUi8zsTC0n/M8FvE3d5stpstofhpAwggECBgNVHR8EgfowgfcwgfSggfGg
      ge6GgbdsZGFwOi8vL0NOPUNPUlBST09UQ0EsQ049TFNWV0lQQVAwMDEsQ049Q0RQ
      LENOPVB1YmxpYyUyMEtleSUyMFNlcnZpY2VzLENOPVNlcnZpY2VzLENOPUNvbmZp
      Z3VyYXRpb24sREM9YWQtaGV3aXR0LERDPWNvbT9jZXJ0aWZpY2F0ZVJldm9jYXRp
      b25MaXN0P2Jhc2U/b2JqZWN0Q2xhc3M9Y1JMRGlzdHJpYnV0aW9uUG9pbnSGMmh0
      dHA6Ly9pbnRQS0kuaGV3aXR0LmNvbS9DZXJ0RW5yb2xsL0NPUlBST09UQ0EuY3Js
      MIIBCgYIKwYBBQUHAQEEgf0wgfowgasGCCsGAQUFBzAChoGebGRhcDovLy9DTj1D
      T1JQUk9PVENBLENOPUFJQSxDTj1QdWJsaWMlMjBLZXklMjBTZXJ2aWNlcyxDTj1T
      ZXJ2aWNlcyxDTj1Db25maWd1cmF0aW9uLERDPWFkLWhld2l0dCxEQz1jb20/Y0FD
      ZXJ0aWZpY2F0ZT9iYXNlP29iamVjdENsYXNzPWNlcnRpZmljYXRpb25BdXRob3Jp
      dHkwSgYIKwYBBQUHMAKGPmh0dHA6Ly9pbnRQS0kuaGV3aXR0LmNvbS9DZXJ0RW5y
      b2xsL0xTVldJUEFQMDAxX0NPUlBST09UQ0EuY3J0MA0GCSqGSIb3DQEBCwUAA4IB
      AQCJmidlXAjO/J5KBNsU9VlQwDdwBbBw1K1J8k+YrVn4I0DRPWztTNHs/+DlfrCZ
      JsR4AMsPOGsgsXHC8O9ZDWcqrJn0ScIKb6P1EgnqoMGpRUu1oJiXSBMCiNw9XIZL
      cAha5UWJHK614RNT0D9WqmxzlDoGWAS6B7Xb8g1BsZ0Ow0aprI9LLRAwA3cG8j4i
      0L77oiO1fOnufBffNCa0T06JkX6NH2LHCXheavql2ODe98Y6Rgn+UayJ0nJTHITC
      S6mxESStAF9xI3yURsrKtDxBU66C83KnstUVLuPAM8ygrDEyFsL+FgXqjogCr5hf
      /d4vwcqKRm2yAz5yyZwgk3+s
      -----END CERTIFICATE----- 